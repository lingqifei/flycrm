<div class="wrapper wrapper-content">
    <div class="row">
        <div class="col-sm-6">
            <div class="ibox">
                <div class="ibox-title">
                    <h5>{:lang("system announcement")}</h5>
                </div>
                <div class="ibox-content">
                    <table class="table table-hover ajax-list-table" data-type="oanotify"
                           data-url="{:url('admin/SysNotify/main_json',array('owner_user_id'=>$sys_user_info.id))}"
                           width="100%">
                        <tbody>

                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <div class="col-sm-6">
            <div class="ibox">
                <div class="ibox-title">
                    <h5>{:lang("system reminder")}</h5>
                </div>
                <div class="ibox-content">
                    <table class="table table-hover ajax-list-table" data-type="sysmsg"
                           data-url="{:url('admin/SysMsg/show_json',array('deal_user_id'=>$sys_user_info.id,'deal_status'=>0))}"
                           width="100%">
                        <tbody>

                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    {notempty name='sys_config.is_grant'}
    {neq name='sys_config.is_grant' value="1"}
    <div class="row">
        <div class="col-sm-6">
            <div class="ibox">
                <div class="ibox-title">
                    <h5>{:lang("system information")}</h5>
                </div>
                <div class="ibox-content collapse in" id="demo">
                    <table class="table table-hover">
                        <tbody>
                        <tr>
                            <td width="20%">{:lang("current version")}</td>
                            <td>{$info['lqf_version']}</td>
                        </tr>
                        <tr>
                            <td>{:lang("operating system")}</td>
                            <td>{$info['os']}</td>
                        </tr>
                        <tr>
                            <td>{:lang("operating environment")}</td>
                            <td>{$info['software']}</td>
                        </tr>
                        <tr>
                            <td>{:lang("mysql version")}</td>
                            <td>{$info['mysql_version']}</td>
                        </tr>
                        <tr>
                            <td>{:lang("php version")}</td>
                            <td>{$info['php_version']}</td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <div class="col-sm-6">
            <div class="ibox">
                <div class="ibox-title">
                    <h5>{:lang("product information")}</h5>
                </div>
                <div class="ibox-content">
                    <table class="table table-hover">
                        <tbody>

                        <tr>
                            <td width="20%">{:lang("product name")}</td>
                            <td>{$info['product_name']}</td>
                        </tr>
                        <tr>
                            <td>{:lang("product design and team")}</td>
                            <td>{$info['author']}</td>
                        </tr>
                        <tr>
                            <td>{:lang("official website")}</td>
                            <td><a target="_blank" href="http://{$info['website']}">{$info['website']}</a></td>
                        </tr>
                        <tr>
                            <td>{:lang("qq communication group")}</td>
                            <td>{$info['qun']}</td>
                        </tr>
                        <tr>
                            <td>{:lang("development manual")}</td>
                            <td>{$info['document']}</td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    {/neq}
    {/notempty}


</div>
<script type="text/javascript">

    //自动加载数据
    $(document).ready(function () {
        $('.ajax-list-table').each(function () {
            var that = $(this);
            ajaxListData(that);
        });
    });

    //加载数据
    function ajaxListData(that) {
        var type = that.attr("data-type");
        var target = that.attr("data-url");

        //是否设置了字段
        var ids = that.attr('data-ids');
        //是否设置了参数字段
        if (typeof (ids) != "undefined" && ids != 0) {
            var ids = ($.param(eval('(' + ids + ')'), true));
            var target = target + "?" + ids;
        }

        $.ajax({
            type: "POST",
            url: target,
            data: {"pageSize": 20},
            dataType: "json",
            async: true,
            beforeSend: function () {
                that.empty();
            },
            success: function (jsondata) {
                var html = ajaxListDataTpl(jsondata.data, type);
                that.html(html);
            },
            complete: function () {
            }
        });
    }

    //加载数据,模板
    function ajaxListDataTpl(data, type) {
        var html = '';
        $.each(data, function (idx, obj) {
            if (type == 'oanotify') {
                html += '<tr>';
                html += '<td width="70"><a class="ajax-open" data-calback="javascript:void(0)" data-ids="{\'id\':\'' + obj.id + '\'}" data-url="{:url(\'SysNotify/main_json\')}" >' + obj.name + '</td></a>';
                html += '<td width="30" class="text-right">' + obj.create_time + '</td>';
                html += '</tr>';
            } else if (type == 'sysmsg') {
                html += '<tr>';
                html += '<td width="10">【' + obj.bus_type_name + '】</td>';
                html += '<td width="70"><a class="ajax-open" data-calback="javascript:void(0)" data-url="' + obj.bus_url + '" >' + obj.bus_name + '</td></a>';
                html += '<td width="20" class="text-right">' + obj.deal_time + '</td>';
                html += '</tr>';
            }
        });
        return html;
    }



</script>