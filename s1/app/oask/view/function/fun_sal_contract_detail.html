<script>
    // 列表加载
    $(document).ready(function () {
        $("body").on("click", ".nav-tabs", function (){
            $(".tab-content").find(".tab-pane.active table.ajax-list-table").each(function(key,row){
                ajaxContractInfoData($(this));
            });
        });
        $(".tab-content").find(".tab-pane table.ajax-list-table").each(function(key,row){
            ajaxContractInfoData($(this));
        })
    })
    
    //订单详细数据加载
    function  ajaxContractInfoData(object){
        target=object.attr("data-url");
        log(target);
        $.ajaxSettings.async = true;
        $.get(target).success(function (jsonData) {
            html=ajaxContractInfoDataTpl(jsonData.data,jsonData.type);
            object.find("tbody").html(html);
            object.find('tfoot label').html(jsonData.total_money);
        },"json");

    }


    //订单详细数据加载
    function  ajaxContractInfoDataTpl(data,type){

        var html="";
        $.each(data,function(key,row) {
            switch (type) {
                case 'list':
                    html += '<tr>';
                    html += '<td>' + row.goods_name + '</td>';
                    html += '<td>' + row.sku_name + '</td>';
                    html += '<td>' + row.sale_price + '</td>';
                    html += '<td>' + row.num + '</td>';
                    html += '<td>' + row.goods_money + '</td>';
                    html += '<td>' + row.remark + '</td>';
                    html += '</tr>';
                    break;
                case 'rece':
                    html += '<tr>';
                    html += '<td>' + row.back_date + '</td>';
                    html += '<td>' + row.stages + '</td>';
                    html += '<td>' + row.money + '</td>';
                    html += '<td>' + row.zero_money + '</td>';
                    html += '<td>' + row.create_user_name + '</td>';
                    html += '<td>' + row.create_time + '</td>';
                    html += '<td>' + row.status_arr.html + '</td>';
                    html += '<td>' + row.remark + '</td>';
                    html += '<td>';
                    if(row.status==0){
                        html += '    <lqf_link><a class="ajax-open" data-url="{:url(\'FinReceRecord/edit\')}"  data-ids="{\'id\':\'' + row.id + '\'}" data-title="修改" data-calback="ajaxContractInfoData($(\'.ajax-list-table.rece\'))">修改</a></lqf_link>';
                        html += '    <lqf_link><a class="ajax-del" data-url="{:url(\'FinReceRecord/del\')}"  data-ids="{\'id\':\'' + row.id + '\'}"  data-calback="ajaxContractInfoData($(\'.ajax-list-table.rece\'))">删除</a></lqf_link>';
                    }
                   html += '</td>';
                    html += '</tr>';
                    break;
                case 'invoice':
                    html += '<tr>';
                    html += '<td>' + row.handle_date + '</td>';
                    html += '<td>' + row.invoice_no + '</td>';
                    html += '<td>' + row.money + '</td>';
                    html += '<td>' + row.stages + '</td>';
                    html += '<td>' + row.handle_user_name + '</td>';
                    html += '<td>' + row.create_time + '</td>';
                    html += '<td>' + row.status_arr.html + '</td>';
                    html += '<td>' + row.remark + '</td>';
                    html += '<td>';
                    if(row.status==0) {
                        html += '    <lqf_link><a class="ajax-open" data-url="{:url(\'FinInvoicePay/edit\')}"  data-ids="{\'id\':\'' + row.id + '\'}" data-title="修改" data-calback="ajaxContractInfoData($(\'.ajax-list-table.invoice\'))">修改</a></lqf_link>';
                        html += '    <lqf_link><a class="ajax-del" data-url="{:url(\'FinInvoicePay/del\')}"  data-ids="{\'id\':\'' + row.id + '\'}"  data-calback="ajaxContractInfoData($(\'.ajax-list-table.invoice\'))">删除</a></lqf_link>';
                    }
                    html += '</td>';
                    html += '</tr>';
                    break;
                default:
                    html = "";
            }
        });
        return html
    }
</script>